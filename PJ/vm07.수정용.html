<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŒë£Œ ìíŒê¸°</title>
    <style>
        #menu {
            width: 90%;
            background-color: #f1f1f1;
            border: 2px solid #333;
            border-radius: 10px;
            margin: 20px auto;
            font-weight: 900;
            font-style: normal;
            text-align: center;
        }

        #menu article button {
            cursor: pointer;
        }

        .drink article {
            background-color: #f1f1f1;
            padding: 10px;
            text-align: center;
            margin: auto;
        }

        #wrapper {
            width: 750px;
            height: 1120px;
            padding: 10px;
            margin: 0 auto;
            border: 3px solid #333;
            border-radius: 10px;
            text-align: center;
            background-color: #afafb1;
        }


        article {
            display: inline-block;
            padding: 10px;
            margin-right: 30px;
        }

        #pocaA {
            margin-right: 50px;
            text-align: center;
        }

        #fantaA {
            margin-left: 70px;
        }

        #led {
            width: 90%;
            margin: 5px auto;
            padding: 10px;
            text-align: center;
            border: 3px solid #333;
        }

        #led input {
            text-align: right;
            padding: 5px;
            border-color: #333;
        }


        #outDrinks {
            position: absolute;
            width: 400px;
            height: 400px;
            bottom: -8em;
            left: -18em;
            display:inline-block;
            position: relative;
            text-align: right;
            background-image: url('out1.png');
            background-repeat: no-repeat;
        }

        #adminToggle {
            display: inline-block;
            float: left;
            margin-left: 10em;
            margin-top: 20px;
            top: 6em;
            background-color: #7e7e7e;
            border: 2px solid #000000;
            padding: 1em;
        }


        #outDrink {
            margin-top: 45px;
            margin-left: -20px;
        }

        #led>label:nth-child(4) {
            margin-left: 3em;
        }

        #coinBox {
            width: 90%;
            height: 120px;
            padding: 10px;
            background-color: #8a8989;
            border-radius: 10px;
            margin: 10px auto;
            border: 3px solid #8a8989;
            vertical-align: baseline;
        }

        #coins {
            display: inline-block;
            text-align: left;
            margin-top: 30px;
            float: left;
        }

        #inCoins {
            float: right;
            display: inline-block;
            width: 150px;
            padding: 1em 2em;
            border: 1px solid #999;
            background-color: #ddd;
            margin: 10px auto;
            border-radius: 10px;
        }

        #coins img {
            cursor: grab;
        }

        #slot {
            width: 100px;
            padding: 10px;
            background-color: #ddd;
            border: 10px solid #555;
            border-radius: 10px;
        }

        #outCoins {
            display: inline-block;
            margin-left: 3em;
        }

        #outCoins button {
            width: 70px;
            height: 70px;
            background-image: url('return.png');
            background-repeat: no-repeat;
            border-radius: 50%;
            border: 3px solid rgb(83, 82, 80);
            margin-bottom: 10px;
            cursor: pointer;
        }

        #inCoins input {
            width: 100px;
            padding: 5px 5px;
            border: 5px solid #999;
            background-color: #333;
            border-radius: 20px;
        }

        .fade-out {
            opacity: 0;
            transition: opacity 1s ease-out;
        }

        #adminPanel {
            width: 300px;
            height: 420px;
            display: none;
            border: 2px solid #000;
            margin-right: 20px;
            margin-top: -25em;
            padding: 10px;
            float: right;
            background: #eee
        }

        #baguni {
            width: 200px;
            display: flex;
            padding: 50px;
        }

        .fieldset {
            margin-bottom: 1em
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <h1>ìŒë£Œ ìíŒê¸°</h1>
        <div id="menu">
            <div class="drink">
                <article id="pocaA">
                    <img src="pocaOut.png" alt="í¬ì¹´ë¦¬">
                    <h3>ê°€ê²© : <span></span>ì›</h3>
                    <button class="drinkBtn" id="poca">í¬ì¹´ë¦¬</button>
                </article>
                <article id="colaA">
                    <img src="colaOut.png" alt="ì½”ì¹´ì½œë¼">
                    <h3>ê°€ê²© : <span></span>ì›</h3>
                    <button class="drinkBtn" id="cola">ì½”ì¹´ì½œë¼</button>
                </article>
                <article id="fantaA">
                    <img src="fantaOut.png" alt="í™˜íƒ€">
                    <h3>ê°€ê²© : <span></span>ì›</h3>
                    <button class="drinkBtn" id="fanta">í™˜íƒ€</button>
                </article>
            </div>
        </div>

        <div id="led">
            <label>ë™ì „: </label>
            <input type="text" id="coin" value="0">ì›
            <button id="inputMoney">ë™ì „ì…ë ¥</button>
            <label>íˆ¬ì…ê¸ˆì•¡:
                <input type="text" id="inMoney" value="0" readonly>ì›
            </label>
        </div>

        <div id="coinBox">
            <div id="coins">
                <img src="coin500.png" class="coin" alt="500">
                <img src="coin100.png" class="coin" alt="100">
                <img src="coin50.png" class="coin" alt="50">
            </div>
            <div id="inCoins">
                <div id="slot"></div>
            </div>

            <div id="outCoins">
                <textarea id="exchangeCoins" rows="2" cols="10"></textarea>
                <button id="exchangCoins"></button>
            </div>
        </div>

        <div style="text-align:center; margin-top:20px;">
            <button id="adminToggle">ğŸ”‘ê´€ë¦¬ì ëª¨ë“œ</button>
        </div>

        <div id="outDrinks">
            <div id="outDrink" style="visibility: hidden;">
                <img src="pocaOut.png" style=""></img>
            </div>
        </div>

        <div id="adminPanel" style="display:none;">
            <h3>ê´€ë¦¬ì íŒ¨ë„</h3>
            <fieldset>
                <legend>ì¬ê³  ì„¤ì •</legend>
                í¬ì¹´ë¦¬: <input type="number" id="stockPoca" value="5"><br>
                ì½”ì¹´ì½œë¼: <input type="number" id="stockCola" value="5"><br>
                í™˜íƒ€: <input type="number" id="stockFanta" value="5"><br>
            </fieldset>

            <fieldset>
                <legend>ê°€ê²© ì„¤ì •</legend>
                í¬ì¹´ë¦¬: <input type="number" id="pricePoca" value="700"><br>
                ì½”ì¹´ì½œë¼: <input type="number" id="priceCola" value="800"><br>
                í™˜íƒ€: <input type="number" id="priceFanta" value="900"><br>
            </fieldset>

            <fieldset>
                <legend>ì´ íŒë§¤ ìˆ˜ì…</legend>
                <p id="totalSalesDisplay">0 ì›</p>
            </fieldset>

            <button id="applyAdminChanges">ë³€ê²½ ì‚¬í•­ ì ìš©</button>
            <button id="closeAdmin">ë‹«ê¸°</button>
        </div>
    </div>


    <div id="baguni">
        <h2>êµ¬ë§¤ ëª©ë¡</h2>
        <div data-name="í¬ì¹´ë¦¬" style="display:none">
            <img src="pocaOut.png" width="80" />
            <p>í¬ì¹´ë¦¬ x <span class="count">0</span></p>
        </div>
        <div data-name="ì½”ì¹´ì½œë¼" style="display:none">
            <img src="colaOut.png" width="80" />
            <p>ì½”ì¹´ì½œë¼ x <span class="count">0</span></p>
        </div>
        <div data-name="í™˜íƒ€" style="display:none">
            <img src="fantaOut.png" width="80" />
            <p>í™˜íƒ€ x <span class="count">0</span></p>
        </div>
    </div>
</body>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const drinkData = {
            "í¬ì¹´ë¦¬": { price: 700, stock: 5, img: "pocaOut", soldOutImg: "pocaSoldout", btnId: "poca" },
            "ì½”ì¹´ì½œë¼": { price: 800, stock: 5, img: "colaOut", soldOutImg: "colaSoldout", btnId: "cola" },
            "í™˜íƒ€": { price: 900, stock: 5, img: "fantaOut", soldOutImg: "fantaSoldout", btnId: "fanta" }
        };

        let totInMoney = 0;
        let VMInMoney = 0; // ì´ íŒë§¤ ìˆ˜ì…
        let isAdmin = false;
        const purchaseCounts = { "í¬ì¹´ë¦¬": 0, "ì½”ì¹´ì½œë¼": 0, "í™˜íƒ€": 0 };
        const $outDrinkImg = document.querySelector('#outDrink img');

        // ê°€ê²© ì´ˆê¸°í™”
        for (const [name, data] of Object.entries(drinkData)) {
            document.querySelector(`#${data.btnId}A span`).textContent = data.price;
        }

        // ë™ì „ ë“œë˜ê·¸
        document.querySelectorAll(".coin").forEach(coin => {
            coin.addEventListener("dragstart", (e) => {
                e.dataTransfer.setData("text", coin.getAttribute("alt"));
            });
        });

        const slot = document.getElementById("slot");
        slot.addEventListener("dragover", e => e.preventDefault());
        slot.addEventListener("drop", e => {
            e.preventDefault();
            const val = parseInt(e.dataTransfer.getData("text"));
            if (!isNaN(val)) {
                totInMoney += val;
                document.getElementById("inMoney").value = totInMoney;

                const img = document.createElement("img");
                img.src = `coin${val}.png`;
                slot.appendChild(img);
                setTimeout(() => img.remove(), 1000);
            }
        });

        document.getElementById("inputMoney").addEventListener("click", () => {
            const val = parseInt(document.getElementById("coin").value);
            if (!isNaN(val)) {
                totInMoney += val;
                document.getElementById("inMoney").value = totInMoney;
            }
        });

        document.getElementById("exchangCoins").addEventListener("click", () => {
            document.getElementById("exchangeCoins").value = totInMoney;
            totInMoney = 0;
            document.getElementById("inMoney").value = 0;
        });

        // ìŒë£Œ êµ¬ë§¤ ë²„íŠ¼ ì´ë²¤íŠ¸
        for (const [name, data] of Object.entries(drinkData)) {
            document.getElementById(data.btnId).addEventListener("click", () => {
                if (data.stock <= 0) {
                    alert(`${name}ê°€ ë§¤ì§„ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    return;
                }
                if (totInMoney < data.price) {
                    alert("íˆ¬ì…ê¸ˆì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");
                    return;
                }

                totInMoney -= data.price;
                VMInMoney += data.price; // ìˆ˜ì… ì¶”ê°€
                document.getElementById("inMoney").value = totInMoney;

                $outDrinkImg.src = `${data.img}.png`;
                $outDrinkImg.style.visibility = "visible";

                data.stock--;
                updateStockDisplay();
                addPurchase(name);
                updateSalesDisplay(); // ìˆ˜ì… í‘œì‹œ ê°±ì‹ 
            });
        }

        // ìŒë£Œ í’ˆì ˆì‹œ ì´ë¯¸ì§€ ì „í™˜
        function updateStockDisplay() {
            for (const [name, data] of Object.entries(drinkData)) {
                const img = document.querySelector(`img[alt="${name}"]`);
                const btn = document.getElementById(data.btnId);
                if (data.stock <= 0) {
                    img.src = `${data.soldOutImg}.png`;
                    btn.disabled = true;
                    img.style.cursor = "not-allowed";
                } else {
                    img.src = `${data.img}.png`;
                    btn.disabled = false;
                    img.style.cursor = "pointer";
                }
            }
        }

        function addPurchase(name) {
            purchaseCounts[name]++;
            const item = document.querySelector(`#baguni div[data-name="${name}"]`);
            item.style.display = "inline-block";
            item.querySelector(".count").textContent = purchaseCounts[name];
        }

        function updateSalesDisplay() {
            document.getElementById("totalSalesDisplay").textContent = `${VMInMoney} ì›`;
        }

        document.getElementById("adminToggle").addEventListener("click", () => {
            const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:");
            if (pw === "1234") {
                isAdmin = true;
                document.getElementById("adminPanel").style.display = "block";

                for (const [name, data] of Object.entries(drinkData)) {
                    const id = data.btnId.charAt(0).toUpperCase() + data.btnId.slice(1);
                    document.getElementById(`stock${id}`).value = data.stock;
                    document.getElementById(`price${id}`).value = data.price;
                }

                updateSalesDisplay(); // ìˆ˜ì… ê°±ì‹ 
            } else {
                alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
            }
        });

        document.getElementById("closeAdmin").addEventListener("click", () => {
            isAdmin = false;
            document.getElementById("adminPanel").style.display = "none";
        });

        document.getElementById("applyAdminChanges").addEventListener("click", () => {
            if (!isAdmin) return;

            for (const [name, data] of Object.entries(drinkData)) {
                const id = data.btnId.charAt(0).toUpperCase() + data.btnId.slice(1);
                data.stock = parseInt(document.getElementById(`stock${id}`).value);
                data.price = parseInt(document.getElementById(`price${id}`).value);
                console.log("data.btnId:" + data.btnId)
                console.log("data.price:" + data.price)
                document.querySelector(`#${data.btnId}A span`).textContent = data.price;
            }

            updateStockDisplay();
            alert("ë³€ê²½ ì‚¬í•­ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.");
        });

        updateStockDisplay();
    });
</script>

</html>